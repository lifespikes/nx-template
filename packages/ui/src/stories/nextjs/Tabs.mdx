import NextjsTabImage from '../assets/nextjstabs.png';

## Introduction

Code duplication in user interface design can be resolved by creating components that manage common patterns. For example, in Payroll UI, tabs are a recurring element on many screens. To facilitate their implementation, taking advantage of the functionalities of Next.js 14, the following file structure is proposed within the `app` directory:

```plaintext
company/
└── (details)/
    ├── @company_details/
    │   └── page.tsx
    ├── @company_locations/
    │   └── page.tsx
    ├── layout.tsx
    └── page.tsx
```

- `company`: Would be a page accessible through `/company`.
- `(details)`: Is a group of routes intended to contain other folders that can be routes, components, or a layout independent at the same level.
- `@company_details` and `@company_locations`: Are parallel routes that represent a tab.
- `layout.tsx`: Is the specific layout for the `(details)` group, where the `withTabs` function is used.
- `page.tsx`: Is the page that is rendered when accessing `/company`.

## Usage

Following the previous structure, the `layout.tsx` file should be modified as follows:

```tsx
// company/(details)/layout.tsx
import WithTabs from '@/modules/global/layout/with-tabs';

export default WithTabs();
```

This modification will automatically take the defined parallel routes (with the "@" prefix) and render them as seen in the following screenshot:

<img src={NextjsTabImage} />

## Specify Page Component

To control where the tabs should be rendered within a page, a component can be passed as the first argument to the `withTabs` function:

```tsx
// company/(details)/layout.tsx
import WithTabs from '@/modules/global/layout/with-tabs';
import { getUser } from "@/hooks/getUser";

const CompanyDetailsPage = ({ children }) => {
    const isUserLogged = !!getUser();
    return (
        <>
            {isUserLogged ? (
                <div>{children}</div>
            ) : (
                <p>Forbidden</p>
            )}
        </>
    );
}

export default WithTabs(CompanyDetailsPage);
```

## Order the Tabs

To specify the order of the tabs, a number can be assigned in the last segment of the name of the parallel route, such as `@company_locations_1`, to determine that this route is rendered first.

```plaintext
company/
└── (details)/
    ├── @company_details/          -> Second tab to be rendered.
    ├── @company_locations_1/      -> First to be rendered.
    ├── layout.tsx
    └── page.tsx
```

## Notes on Multiple Tab Structures at the Same Route Level

Next.js inherits layouts to the subroutes where they are defined, which can generate conflicts, especially when there are multiple tabs at the same route level. For example, if we have a route `/companies` with tabs and another route `/companies/[id]` for the details of a company, the initial structure would be:

```plaintext
companies/
└── [id]/
    ├── page.tsx
    ├── layout.tsx
└── page.tsx
└── layout.tsx
```

Using the `withTabs` function in both layouts would cause a conflict. To resolve this, the [route grouping](https://nextjs.org/docs/app/building-your-application/routing/route-groups) feature of Next.js can be used, allowing for independent layouts for each route segment and thus avoiding conflicts. The final structure would look like this:

```plaintext
companies/
└── (details)/                      -> Route group.
    ├── [id]/ 
    │   ├── billing_2/
    │   ├── @company_details_1/
    │   ├── payrolls_4/
    │   └── @workers_comp_3/
    │   ├── layout.tsx
    │   └── page.tsx
└── (list)/                          -> Route group.
    ├── @list_of_companies_1/
    ├── layout.tsx
    └── page.tsx
```

With this structure, `(details)` and `(list)` act as route groups that do not represent a URL segment, allowing `page.tsx` in `(list)` to be the page displayed on `/companies`, and each route group to have its own independent layout."